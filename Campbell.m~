clc; close all;
%warning off Control:ltiobject:TFComplex

%**** Variables
%m=300;
% Jt=100;
% Jp = 20;
% %Omega=0:10:1000;
% Omega = 5;
% cr1=1;cr2=1;cr3=1;cr4=1;
% cn1=1;cn2=1;cn3=1;cn4=1;
% K11=5;K12=2;K22=2;

m = 10;
Jt = 10;
Jp = 10;
Omega = 0:400;
cr1 = 04; cr2 = 05; cr3 = 0; cr4 = 0;
cn1 = 10; cn2 = 01; cn3 = 0; cn4 = 09;
K11 = 500; K12 = 1340; K21 = K12; K22 = 299;


%*** Matrices
M = [m 0; 0 Jt];
C = [cr1+cn1 cr2+cn2; cr3+cn3 cr4+cn4];
K = [K11 K12; K21 K22];
s = tf('s');

poles_system = [];


for n = 1:length(Omega)
    
G=[0 0; 0 -i*Omega(n)*Jp];
eq_mat = M*s^2 + (C+G)*s + K;
sys = inv(eq_mat);
poles = pole(sys);
poles_system = [poles_system  poles];
%display(poles);
K11 = K11 + 100;
K12 = K12 + 100;
K21 = K21 + 100;
K22 = K22 + 100;
end

if size(poles_system,1) == 4
    subplot(2,1,1)
    plot(Omega, real(poles_system(1,:)), 'b', Omega, real(poles_system(2,:)), 'r');   
    subplot(2,1,2)
    plot(Omega, imag(poles_system(1,:)), 'b', Omega, imag(poles_system(2,:)), 'r');   
elseif size(poles_system,1) == 6
    subplot(2,1,1)
    plot(Omega, real(poles_system(1,:)), 'b', Omega, real(poles_system(2,:)), 'r', Omega, real(poles_system(3,:)), 'g');
    subplot(2,1,2)
    plot(Omega, imag(poles_system(1,:)), 'b', Omega, imag(poles_system(2,:)), 'r', Omega, imag(poles_system(3,:)), 'g');
elseif size(poles_system,1) == 8
    figure
    subplot(2,1,1)
    plot(Omega, real(poles_system(1,:)), 'b', Omega, real(poles_system(2,:)), 'r', Omega, real(poles_system(3,:)), 'g', Omega, real(poles_system(4,:)), 'k');
    title('Diagramme de Campbell');
    xlabel('Vitesse de rotation');
    ylabel('Re(s)');


    subplot(2,1,2)
    plot(Omega, imag(poles_system(1,:)), 'b', Omega, imag(poles_system(2,:)), 'r', Omega, imag(poles_system(3,:)), 'g', Omega, imag(poles_system(4,:)), 'k');
    xlabel('Vitesse de rotation');
    ylabel('Im(s)');


end

%display(poles_system(1,:));
%display(poles_system);
poles_1 = poles_system(1,:);
%display(poles_1)

%plot(j, poles_1);

